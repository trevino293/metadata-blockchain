<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
			<meta name="viewport" content="width=device-width, initial-scale=1.0">
				<title>COBOL-Blockchain Integration Dashboard</title>
				<style>
					* {
					margin: 0;
					padding: 0;
					box-sizing: border-box;
					}

					body {
					font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
					background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
					color: #333;
					min-height: 100vh;
					padding: 20px;
					}

					.container {
					max-width: 1400px;
					margin: 0 auto;
					}

					.header {
					background: rgba(255, 255, 255, 0.95);
					padding: 20px 30px;
					border-radius: 15px;
					box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
					margin-bottom: 30px;
					backdrop-filter: blur(10px);
					}

					.header h1 {
					color: #1e3c72;
					font-size: 2.2em;
					margin-bottom: 8px;
					}

					.header p {
					color: #666;
					font-size: 1em;
					}

					.status-bar {
					display: flex;
					gap: 15px;
					margin-top: 15px;
					flex-wrap: wrap;
					}

					.status-item {
					background: #f8f9fa;
					padding: 12px 20px;
					border-radius: 8px;
					flex: 1;
					min-width: 160px;
					text-align: center;
					transition: transform 0.3s ease;
					border: 2px solid transparent;
					}

					.status-item:hover {
					transform: translateY(-2px);
					}

					.status-item.active {
					background: #e8f5e8;
					border-color: #4CAF50;
					color: #2e7d32;
					}

					.status-item.inactive {
					background: #ffebee;
					border-color: #f44336;
					color: #c62828;
					}

					.status-item strong {
					display: block;
					font-size: 0.9em;
					margin-bottom: 4px;
					}

					.status-item span {
					font-size: 0.85em;
					}

					.controls {
					display: flex;
					gap: 15px;
					margin-bottom: 30px;
					align-items: center;
					flex-wrap: wrap;
					background: rgba(255, 255, 255, 0.1);
					padding: 15px;
					border-radius: 10px;
					backdrop-filter: blur(10px);
					}

					.btn {
					background: linear-gradient(45deg, #2a5298, #1e3c72);
					color: white;
					border: none;
					padding: 10px 20px;
					border-radius: 8px;
					cursor: pointer;
					font-size: 0.9em;
					font-weight: 500;
					transition: all 0.3s ease;
					display: flex;
					align-items: center;
					gap: 8px;
					}

					.btn:hover {
					transform: translateY(-2px);
					box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
					}

					.btn.secondary {
					background: #6c757d;
					}

					.btn.secondary:hover {
					background: #5a6268;
					}

					.filter-input {
					padding: 10px 15px;
					border: 2px solid rgba(255, 255, 255, 0.3);
					border-radius: 8px;
					font-size: 0.9em;
					flex: 1;
					min-width: 200px;
					background: rgba(255, 255, 255, 0.9);
					transition: border-color 0.3s ease;
					}

					.filter-input:focus {
					outline: none;
					border-color: #2a5298;
					}

					/* Statistics Section */
					.stats-section {
					background: rgba(255, 255, 255, 0.95);
					padding: 20px;
					border-radius: 12px;
					margin-bottom: 20px;
					box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
					}

					.stats-grid {
					display: grid;
					grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
					gap: 15px;
					}

					.stat-card {
					background: #f8f9fa;
					padding: 15px;
					border-radius: 8px;
					text-align: center;
					transition: all 0.3s ease;
					border: 2px solid #e9ecef;
					}

					.stat-card:hover {
					transform: translateY(-3px);
					box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
					border-color: #2a5298;
					}

					.stat-number {
					font-size: 1.8em;
					font-weight: bold;
					color: #2a5298;
					margin: 5px 0;
					}

					.stat-label {
					color: #666;
					font-size: 0.85em;
					font-weight: 500;
					}

					/* Tabbed Table Section */
					.table-section {
					background: rgba(255, 255, 255, 0.95);
					border-radius: 12px;
					box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
					overflow: hidden;
					}

					.tab-container {
					border-bottom: 1px solid #e9ecef;
					}

					.tab-nav {
					display: flex;
					background: #f8f9fa;
					justify-content: flex-start;
					padding: 0;
					}

					.tab-button {
					background: none;
					border: none;
					padding: 12px 20px;
					cursor: pointer;
					font-size: 0.9em;
					font-weight: 500;
					color: #666;
					transition: all 0.3s ease;
					border-bottom: 3px solid transparent;
					border-radius: 8px 8px 0 0;
					margin-right: 2px;
					position: relative;
					}

					.tab-button:hover {
					background: #e9ecef;
					color: #333;
					}

					.tab-button.active {
					background: white;
					color: #2a5298;
					border-bottom-color: #2a5298;
					z-index: 1;
					}

					.tab-content {
					padding: 20px;
					}

					.tab-pane {
					display: none;
					}

					.tab-pane.active {
					display: block;
					}

					.data-table {
					width: 100%;
					border-collapse: collapse;
					margin-bottom: 20px;
					}

					.data-table th,
					.data-table td {
					padding: 12px;
					text-align: left;
					border-bottom: 1px solid #e9ecef;
					}

					.data-table th {
					background: #f8f9fa;
					font-weight: 600;
					color: #333;
					font-size: 0.9em;
					}

					.data-table tr:hover {
					background: #f8f9fa;
					}

					.data-table td {
					font-size: 0.85em;
					}

					/* Pagination */
					.pagination {
					display: flex;
					justify-content: space-between;
					align-items: center;
					margin-top: 15px;
					padding-top: 15px;
					border-top: 1px solid #e9ecef;
					}

					.pagination-info {
					color: #666;
					font-size: 0.85em;
					}

					.pagination-controls {
					display: flex;
					gap: 10px;
					align-items: center;
					}

					.page-btn {
					background: #f8f9fa;
					border: 1px solid #dee2e6;
					padding: 8px 12px;
					border-radius: 6px;
					cursor: pointer;
					font-size: 0.85em;
					transition: all 0.3s ease;
					}

					.page-btn:hover:not(:disabled) {
					background: #e9ecef;
					}

					.page-btn:disabled {
					opacity: 0.5;
					cursor: not-allowed;
					}

					.page-btn.active {
					background: #2a5298;
					color: white;
					border-color: #2a5298;
					}

					.loading {
					text-align: center;
					padding: 40px;
					color: #999;
					}

					.loading::after {
					content: '';
					animation: dots 1.5s steps(4, end) infinite;
					}

					@keyframes dots {
					0%, 20% { content: ''; }
					40% { content: '.'; }
					60% { content: '..'; }
					80%, 100% { content: '...'; }
					}

					.no-data {
					text-align: center;
					padding: 40px;
					color: #999;
					font-style: italic;
					}

					.refresh-indicator {
					display: inline-block;
					animation: spin 2s linear infinite;
					opacity: 0;
					transition: opacity 0.3s ease;
					}

					.refresh-indicator.active {
					opacity: 1;
					}

					@keyframes spin {
					from { transform: rotate(0deg); }
					to { transform: rotate(360deg); }
					}

					@media (max-width: 768px) {
					.container {
					padding: 10px;
					}

					.header {
					padding: 15px 20px;
					}

					.header h1 {
					font-size: 1.8em;
					}

					.stats-grid {
					grid-template-columns: repeat(2, 1fr);
					}

					.controls {
					flex-direction: column;
					align-items: stretch;
					}

					.tab-nav {
					flex-direction: column;
					}
					}
				</style>
			</head>
	<body>
		<div class="container">
			<div class="header">
				<h1>COBOL-Blockchain Integration Dashboard</h1>
				<p>Real-time monitoring of legacy COBOL systems integrated with Hyperledger Fabric</p>

				<div class="status-bar">
					<div class="status-item active" id="cobol-status">
						<strong>COBOL System</strong>
						<span>Active</span>
					</div>
					<div class="status-item active" id="blockchain-status">
						<strong>Blockchain</strong>
						<span>Connected</span>
					</div>
					<div class="status-item" id="adapter-status">
						<strong>Adapter</strong>
						<span>Running</span>
					</div>
					<div class="status-item" id="last-sync">
						<strong>Last Sync</strong>
						<span id="sync-time">Never</span>
					</div>
				</div>
			</div>

			<div class="controls">
				<button class="btn" onclick="refreshData()">
					Refresh Data
					<span class="refresh-indicator" id="refresh-indicator">⟳</span>
				</button>
				<button class="btn secondary" onclick="clearFilters()">Clear Filters</button>
				<input type="text" class="filter-input" id="filter-input" placeholder="Filter by record ID or file name...">
					<button class="btn" onclick="simulateTransaction()">Simulate Transaction</button>
				</div>

			<!-- Statistics Section -->
			<div class="stats-section">
				<div class="stats-grid">
					<div class="stat-card">
						<div class="stat-number" id="total-transactions">0</div>
						<div class="stat-label">Total Transactions</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="total-blocks">0</div>
						<div class="stat-label">Total Blocks</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="active-files">0</div>
						<div class="stat-label">Active Files</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="pending-ops">0</div>
						<div class="stat-label">Pending Operations</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="error-count">0</div>
						<div class="stat-label">Errors (24h)</div>
					</div>
					<div class="stat-card">
						<div class="stat-number" id="throughput">0</div>
						<div class="stat-label">Ops/Min</div>
					</div>
				</div>
			</div>

			<!-- Tabbed Table Section -->
			<div class="table-section">
				<div class="tab-container">
					<div class="tab-nav">
						<button class="tab-button active" onclick="switchTab('transactions')">
							Recent Transactions
						</button>
						<button class="tab-button" onclick="switchTab('blocks')">
							Blockchain Blocks
						</button>
					</div>
				</div>

				<div class="tab-content">
					<!-- Transactions Tab -->
					<div id="transactions-tab" class="tab-pane active">
						<div class="loading" id="transactions-loading">Loading transactions</div>
						<div id="transactions-data" style="display: none;">
							<table class="data-table">
								<thead>
									<tr>
										<th>Transaction ID</th>
										<th>Operation</th>
										<th>Entity</th>
										<th>Source File</th>
										<th>Timestamp</th>
										<th>Status</th>
									</tr>
								</thead>
								<tbody id="transactions-tbody">
									<!-- Dynamic content -->
								</tbody>
							</table>
							<div class="pagination">
								<div class="pagination-info" id="transactions-info">
									Showing 0-0 of 0 transactions
								</div>
								<div class="pagination-controls">
									<button class="page-btn" id="trans-prev" onclick="previousPage('transactions')" disabled="">
										← Previous
									</button>
									<span id="trans-page-numbers"></span>
									<button class="page-btn" id="trans-next" onclick="nextPage('transactions')">
										Next →
									</button>
								</div>
							</div>
						</div>
						<div id="transactions-no-data" class="no-data" style="display: none;">
							No transactions found
						</div>
					</div>

					<!-- Blocks Tab -->
					<div id="blocks-tab" class="tab-pane">
						<div class="loading" id="blocks-loading">Loading blocks</div>
						<div id="blocks-data" style="display: none;">
							<table class="data-table">
								<thead>
									<tr>
										<th>Block Number</th>
										<th>Hash</th>
										<th>Previous Hash</th>
										<th>Transactions</th>
										<th>Timestamp</th>
										<th>Size</th>
									</tr>
								</thead>
								<tbody id="blocks-tbody">
									<!-- Dynamic content -->
								</tbody>
							</table>
							<div class="pagination">
								<div class="pagination-info" id="blocks-info">
									Showing 0-0 of 0 blocks
								</div>
								<div class="pagination-controls">
									<button class="page-btn" id="blocks-prev" onclick="previousPage('blocks')" disabled="">
										← Previous
									</button>
									<span id="blocks-page-numbers"></span>
									<button class="page-btn" id="blocks-next" onclick="nextPage('blocks')">
										Next →
									</button>
								</div>
							</div>
						</div>
						<div id="blocks-no-data" class="no-data" style="display: none;">
							No blocks found
						</div>
					</div>
				</div>
			</div>
		</div>

		<script>
			// Global state
			let currentTab = 'transactions';
			let currentPage = { transactions: 1, blocks: 1 };
			let pageSize = 10;
			let totalPages = { transactions: 1, blocks: 1 };
			let allData = { transactions: [], blocks: [] };
			let filteredData = { transactions: [], blocks: [] };

			// API configuration
			const API_BASE_URL = 'http://localhost:8080';
			const API_ENDPOINTS = {
			status: '/status',
			transactions: '/api/transactions', // Updated to match your API
			blocks: '/api/blocks', // Updated to match your API
			stats: '/api/stats'
			};

			// Initialize dashboard
			document.addEventListener('DOMContentLoaded', function() {
			refreshData();
			checkSystemStatus();
			setInterval(refreshData, 30000); // Auto-refresh every 30 seconds
			setInterval(checkSystemStatus, 60000); // Check status every minute
			});

			// Fetch data from API
			async function fetchData(endpoint) {
			try {
			const response = await fetch(API_BASE_URL + endpoint);
			if (!response.ok) {
			throw new Error(`HTTP error! status: ${response.status}`);
			}
			return await response.json();
			} catch (error) {
			console.error(`Error fetching ${endpoint}:`, error);
			updateConnectionStatus(false);
			return null;
			}
			}

			async function loadTransactions() {
			const data = await fetchData(API_ENDPOINTS.transactions);
			if (data && data.transactions && Array.isArray(data.transactions)) {
			allData.transactions = data.transactions;
			filteredData.transactions = [...data.transactions];
			} else {
			// Fallback to empty array if API fails
			allData.transactions = [];
			filteredData.transactions = [];
			}
			}

			async function loadBlocks() {
			const data = await fetchData(API_ENDPOINTS.blocks);
			if (data && data.blocks && Array.isArray(data.blocks)) {
			allData.blocks = data.blocks;
			filteredData.blocks = [...data.blocks];
			} else {
			// Fallback to empty array if API fails
			allData.blocks = [];
			filteredData.blocks = [];
			}
			}

			async function loadStatistics() {
			const data = await fetchData(API_ENDPOINTS.stats);
			if (data) {
			updateStatistics(data);
			} else {
			// Use default values if API fails
			updateStatistics({
			totalTransactions: allData.transactions.length,
			totalBlocks: allData.blocks.length,
			filesMonitored: 0,
			successRate: 0,
			pendingOps: 0,
			errorCount: 0
			});
			}
			}

			async function checkSystemStatus() {
			const data = await fetchData(API_ENDPOINTS.status);
			if (data) {
			updateSystemStatus(data);
			updateConnectionStatus(true);
			} else {
			updateConnectionStatus(false);
			}
			}

			function switchTab(tabName) {
			// Update tab buttons
			document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
			event.target.classList.add('active');

			// Update tab panes
			document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
			document.getElementById(tabName + '-tab').classList.add('active');

			currentTab = tabName;
			renderTable(tabName);
			}

			function refreshData() {
			const indicator = document.getElementById('refresh-indicator');
			indicator.classList.add('active');

			// Load all data concurrently
			Promise.all([
			loadTransactions(),
			loadBlocks(),
			loadStatistics()
			]).then(() => {
			renderTable(currentTab);
			updateSyncTime();
			indicator.classList.remove('active');
			}).catch(error => {
			console.error('Error refreshing data:', error);
			indicator.classList.remove('active');
			});
			}

			function updateStatistics(data = {}) {
			document.getElementById('total-transactions').textContent = data.totalTransactions || allData.transactions.length;
			document.getElementById('total-blocks').textContent = data.totalBlocks || allData.blocks.length;
			document.getElementById('active-files').textContent = data.filesMonitored || '0';
			document.getElementById('pending-ops').textContent = data.pendingOps || '0';
			document.getElementById('error-count').textContent = data.errorCount || '0';
			document.getElementById('throughput').textContent = data.successRate || '0';
			}

			function updateSystemStatus(statusData) {
			// Update COBOL system status
			const cobolStatus = document.getElementById('cobol-status');
			if (statusData.cobolSystem === 'active' || statusData.cobol?.active) {
			cobolStatus.className = 'status-item active';
			cobolStatus.querySelector('span').textContent = 'Active';
			} else {
			cobolStatus.className = 'status-item inactive';
			cobolStatus.querySelector('span').textContent = 'Inactive';
			}

			// Update blockchain status
			const blockchainStatus = document.getElementById('blockchain-status');
			if (statusData.blockchain === 'connected' || statusData.blockchain?.connected || statusData.status === 'running') {
			blockchainStatus.className = 'status-item active';
			blockchainStatus.querySelector('span').textContent = 'Connected';
			} else {
			blockchainStatus.className = 'status-item inactive';
			blockchainStatus.querySelector('span').textContent = 'Disconnected';
			}

			// Update adapter status
			const adapterStatus = document.getElementById('adapter-status');
			if (statusData.adapter === 'running' || statusData.adapter?.running || statusData.status === 'running') {
			adapterStatus.className = 'status-item active';
			adapterStatus.querySelector('span').textContent = 'Running';
			} else {
			adapterStatus.className = 'status-item inactive';
			adapterStatus.querySelector('span').textContent = 'Stopped';
			}
			}

			function updateConnectionStatus(connected) {
			const statusItems = document.querySelectorAll('.status-item');
			if (!connected) {
			statusItems.forEach(item => {
			if (!item.classList.contains('inactive')) {
			item.classList.remove('active');
			item.classList.add('inactive');
			item.querySelector('span').textContent = 'Disconnected';
			}
			});
			}
			}

			function updateSyncTime() {
			document.getElementById('sync-time').textContent = new Date().toLocaleTimeString();
			}

			function renderTable(tabName) {
			const data = filteredData[tabName];
			const tbody = document.getElementById(tabName + '-tbody');
			const loading = document.getElementById(tabName + '-loading');
			const dataDiv = document.getElementById(tabName + '-data');
			const noDataDiv = document.getElementById(tabName + '-no-data');

			// Show loading
			loading.style.display = 'block';
			dataDiv.style.display = 'none';
			noDataDiv.style.display = 'none';

			setTimeout(() => {
			if (data.length === 0) {
			loading.style.display = 'none';
			noDataDiv.style.display = 'block';
			return;
			}

			// Calculate pagination
			totalPages[tabName] = Math.ceil(data.length / pageSize);
			const startIndex = (currentPage[tabName] - 1) * pageSize;
			const endIndex = Math.min(startIndex + pageSize, data.length);
			const pageData = data.slice(startIndex, endIndex);

			// Render table rows
			tbody.innerHTML = '';
			pageData.forEach(item => {
			const row = createTableRow(tabName, item);
			tbody.appendChild(row);
			});

			// Update pagination info
			updatePaginationInfo(tabName, startIndex, endIndex, data.length);
			updatePaginationControls(tabName);

			loading.style.display = 'none';
			dataDiv.style.display = 'block';
			}, 500);
			}

			function createTableRow(tabName, item) {
			const row = document.createElement('tr');

			if (tabName === 'transactions') {
			row.innerHTML = `
			<td>${item.id}</td>
			<td>
				<span class="operation-badge">${item.operation}</span>
			</td>
			<td>${item.entity}</td>
			<td>${item.file}</td>
			<td>${formatDate(item.timestamp)}</td>
			<td>
				<span class="status-badge ${item.status.toLowerCase()}">${item.status}</span>
			</td>
			`;
			} else if (tabName === 'blocks') {
			row.innerHTML = `
			<td>${item.number}</td>
			<td>${item.hash}</td>
			<td>${item.prevHash}</td>
			<td>${item.transactions}</td>
			<td>${formatDate(item.timestamp)}</td>
			<td>${item.size}</td>
			`;
			}

			return row;
			}

			function updatePaginationInfo(tabName, startIndex, endIndex, total) {
			const info = document.getElementById(tabName + '-info');
			info.textContent = `Showing ${startIndex + 1}-${endIndex} of ${total} ${tabName}`;
			}

			function updatePaginationControls(tabName) {
			const prevBtn = document.getElementById(tabName === 'transactions' ? 'trans-prev' : 'blocks-prev');
			const nextBtn = document.getElementById(tabName === 'transactions' ? 'trans-next' : 'blocks-next');
			const pageNumbers = document.getElementById(tabName === 'transactions' ? 'trans-page-numbers' : 'blocks-page-numbers');

			prevBtn.disabled = currentPage[tabName] <= 1;
			nextBtn.disabled = currentPage[tabName] >= totalPages[tabName];

			// Generate smart page numbers (show first few, current, and last few)
			pageNumbers.innerHTML = '';

			if (totalPages[tabName] <= 7) {
			// Show all pages if 7 or fewer
			for (let i = 1; i <= totalPages[tabName]; i++) {
			const pageBtn = createPageButton(tabName, i);
			pageNumbers.appendChild(pageBtn);
			}
			} else {
			// Smart pagination: show first, current range, and last
			const current = currentPage[tabName];
			const total = totalPages[tabName];

			// Always show page 1
			pageNumbers.appendChild(createPageButton(tabName, 1));

			if (current > 4) {
			// Add ellipsis if current page is far from start
			const ellipsis = document.createElement('span');
			ellipsis.textContent = '...';
			ellipsis.className = 'page-ellipsis';
			pageNumbers.appendChild(ellipsis);
			}

			// Show pages around current page
			const start = Math.max(2, current - 1);
			const end = Math.min(total - 1, current + 1);

			for (let i = start; i <= end; i++) {
			if (i !== 1 && i !== total) {
			pageNumbers.appendChild(createPageButton(tabName, i));
			}
			}

			if (current < total - 3) {
                    // Add ellipsis if current page is far from end
                    const ellipsis = document.createElement('span');
                    ellipsis.textContent = '...';
                    ellipsis.className = 'page-ellipsis';
                    pageNumbers.appendChild(ellipsis);
                }
                
                // Always show last page (if not already shown)
                if (total > 1) {
                    pageNumbers.appendChild(createPageButton(tabName, total));
                }
            }
        }

        function createPageButton(tabName, pageNum) {
            const pageBtn = document.createElement('button');
            pageBtn.className = `page-btn ${pageNum === currentPage[tabName] ? 'active' : ''}`;
            pageBtn.textContent = pageNum;
            pageBtn.onclick = () => goToPage(tabName, pageNum);
            return pageBtn;
        }

        function previousPage(tabName) {
            if (currentPage[tabName] > 1) {
                currentPage[tabName]--;
                renderTable(tabName);
            }
        }

        function nextPage(tabName) {
            if (currentPage[tabName] < totalPages[tabName]) {
                currentPage[tabName]++;
                renderTable(tabName);
            }
        }

        function goToPage(tabName, page) {
            currentPage[tabName] = page;
            renderTable(tabName);
        }

        function clearFilters() {
            document.getElementById('filter-input').value = '';
            filteredData.transactions = [...allData.transactions];
            filteredData.blocks = [...allData.blocks];
            currentPage.transactions = 1;
            currentPage.blocks = 1;
            renderTable(currentTab);
        }

        function simulateTransaction() {
            const newTransaction = {
                id: 'TX' + String(Date.now()).slice(-6),
                operation: ['CREATE', 'UPDATE', 'DELETE'][Math.floor(Math.random() * 3)],
                entity: ['CustomerRecord', 'AccountBalance', 'TransactionLog'][Math.floor(Math.random() * 3)],
                file: ['CUSTOMER.DAT', 'ACCOUNTS.DAT', 'TRANS.DAT'][Math.floor(Math.random() * 3)],
                timestamp: new Date().toISOString(),
                status: Math.random() > 0.3 ? 'Confirmed' : 'Pending'
            };

            allData.transactions.unshift(newTransaction);
            filteredData.transactions.unshift(newTransaction);
            
            if (currentTab === 'transactions') {
                renderTable('transactions');
            }
            updateStatistics();
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString();
        }

        // Filter functionality
        document.getElementById('filter-input').addEventListener('input', function(e) {
            const filter = e.target.value.toLowerCase();
            
            filteredData.transactions = allData.transactions.filter(item => 
                (item.id || '').toLowerCase().includes(filter) ||
                (item.operation || '').toLowerCase().includes(filter) ||
                (item.entity || item.record_id || '').toLowerCase().includes(filter) ||
                (item.file || item.source_file || '').toLowerCase().includes(filter)
            );
            
            filteredData.blocks = allData.blocks.filter(item => 
                (item.number || item.index || '').toString().includes(filter) ||
                (item.hash || '').toLowerCase().includes(filter)
            );
            
            currentPage.transactions = 1;
            currentPage.blocks = 1;
            renderTable(currentTab);
        });

        // Add some debugging to help identify the issue
        function debugData() {
            console.log('=== DEBUG INFO ===');
            console.log('All transactions data:', allData.transactions);
            console.log('All blocks data:', allData.blocks);
            console.log('Filtered transactions data:', filteredData.transactions);
            console.log('Filtered blocks data:', filteredData.blocks);
            console.log('Current tab:', currentTab);
            console.log('==================');
        }

        // Call debug on refresh (remove this after debugging)
        window.debugData = debugData;
		</script>

		<style>
			.operation-badge {
			padding: 4px 8px;
			border-radius: 4px;
			font-size: 0.75em;
			font-weight: 600;
			background: #e3f2fd;
			color: #1976d2;
			}

			.status-badge {
			padding: 4px 8px;
			border-radius: 4px;
			font-size: 0.75em;
			font-weight: 600;
			}

			.status-badge.confirmed {
			background: #e8f5e8;
			color: #2e7d32;
			}

			.status-badge.pending {
			background: #fff3e0;
			color: #f57c00;
			}
		</style>
	</body>
</html>